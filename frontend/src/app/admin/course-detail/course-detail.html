<!-- HI·ªÇN TH·ªä TR·∫†NG TH√ÅI ƒêANG LOAD -->
<div *ngIf="isLoading" class="text-center text-muted py-5">
  <div class="spinner-border text-primary" role="status"></div>
  <p class="mt-3">ƒêang t·∫£i d·ªØ li·ªáu kh√≥a h·ªçc...</p>
</div>

<!-- KHI C√ì D·ªÆ LI·ªÜU -->
<div class="container py-5" *ngIf="!isLoading && (course || (lessons && lessons.length > 0))">

  <!-- TI√äU ƒê·ªÄ KH√ìA H·ªåC -->
  <h1 class="fw-bold mb-2">{{ course?.title }}</h1>
  <p class="text-muted mb-4">{{ course?.description }}</p>

  <h4 class="fw-semibold mb-3">N·ªôi dung kh√≥a h·ªçc ({{ lessons.length }} b√†i)</h4>

  <!-- DANH S√ÅCH B√ÄI H·ªåC THEO D·ªåC -->
  <ul class="list-group list-group-flush shadow-sm border rounded">
    <li *ngFor="let lesson of lessons; let i = index" class="list-group-item py-3">

      <!-- üîπ Ch·∫ø ƒë·ªô XEM -->
      <div *ngIf="editingLesson?.id !== lesson.id" class="d-flex justify-content-between align-items-center">
        <div>
          <strong>{{ i + 1 }}. {{ lesson.title }}</strong>
          <small class="text-muted d-block">{{ lesson.duration }} ph√∫t</small>
        </div>

        <div class="d-flex align-items-center gap-2">
          <button class="btn btn-outline-primary btn-sm rounded-pill" (click)="goToLessonDetail(lesson.id)">Xem</button>
          <button class="btn btn-outline-warning btn-sm" (click)="editLesson(lesson)">
            <i class="fas fa-edit"></i>
          </button>
          <button class="btn btn-outline-danger btn-sm" (click)="deleteLesson(lesson.id)">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>

      <!-- üîπ Ch·∫ø ƒë·ªô S·ª¨A -->
      <div *ngIf="editingLesson?.id === lesson.id" class="d-flex flex-column gap-2">

        <div class="d-flex gap-3 align-items-center">
          <input type="text" class="form-control form-control-sm" [(ngModel)]="editingLesson.title"
            placeholder="Ti√™u ƒë·ªÅ b√†i h·ªçc" />

          <input type="number" class="form-control form-control-sm" [(ngModel)]="editingLesson.duration"
            placeholder="Th·ªùi l∆∞·ª£ng (ph√∫t)" />
        </div>

        <div class="mt-2 d-flex justify-content-end gap-2">
          <button class="btn btn-success btn-sm" (click)="saveLesson()">
            ‚úÖ L∆∞u
          </button>
          <button class="btn btn-secondary btn-sm" (click)="cancelEdit()">
            ‚ùå H·ªßy
          </button>
        </div>
      </div>

    </li>
  </ul>

  <!-- ‚úÖ N√öT TH√äM B√ÄI H·ªåC (ch·ªâ hi·ªán 1 l·∫ßn ·ªü cu·ªëi danh s√°ch) -->
  <div class="text-center mt-4">
    <button class="btn btn-primary" (click)="openAddLesson()">
      <i class="fas fa-plus"></i> Th√™m b√†i h·ªçc
    </button>
  </div>

  <!-- ‚úÖ FORM TH√äM B√ÄI H·ªåC -->
  <div *ngIf="showAddForm" class="card mt-3 shadow-sm border-0">
    <div class="card-body">
      <h5 class="fw-bold mb-3 text-primary">Th√™m b√†i h·ªçc m·ªõi</h5>

      <div class="row g-3">
        <div class="col-md-6">
          <input class="form-control" placeholder="Ti√™u ƒë·ªÅ b√†i h·ªçc" [(ngModel)]="newLesson.title">
        </div>
        <div class="col-md-6">
          <input type="number" class="form-control" placeholder="Th·ªùi l∆∞·ª£ng (ph√∫t)" [(ngModel)]="newLesson.duration">
        </div>
        <div class="col-12">
          <input class="form-control" placeholder="Video URL" [(ngModel)]="newLesson.videoUrl">
        </div>
        <div class="col-12">
          <textarea class="form-control" rows="3" placeholder="M√¥ t·∫£ b√†i h·ªçc"
            [(ngModel)]="newLesson.description"></textarea>
        </div>
      </div>

      <div class="mt-3 d-flex justify-content-end gap-2">
        <button class="btn btn-success" (click)="addLesson()">
          <i class="fas fa-save"></i> L∆∞u
        </button>
        <button class="btn btn-secondary" (click)="showAddForm = false">
          <i class="fas fa-times"></i> H·ªßy
        </button>
      </div>
    </div>
  </div>

</div>

<!-- KHI KH√îNG C√ì D·ªÆ LI·ªÜU -->
<div *ngIf="!isLoading && lessons.length === 0" class="text-center text-muted py-5">
  Kh√¥ng c√≥ b√†i h·ªçc n√†o trong kh√≥a h·ªçc n√†y.
</div>
